<!DOCTYPE html><html lang=it><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Smart Machinery Lab - Presezzi Extrusion SPA</title><link rel=stylesheet href=styles.css><link rel=stylesheet href=docs_styles.css><script src=https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js></script><link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600;700&display=swap" rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js></script><script src=i18n.js></script></head><body><header class=header><div class=header-content><img src=logos/logo.png alt="Presezzi Extrusion SPA Logo" class=logo></div></header><main class=main-container><div class=background-animation><div class="circle circle-1"></div><div class="circle circle-2"></div><div class="circle circle-3"></div><div class="circle circle-4"></div></div><div class=login-container><div class=login-box><div class=login-header><img src=logos/logo.png alt="Presezzi Extrusion SPA Logo" class=login-logo><h1 class=login-title>Smart Machinery Lab</h1><p class=login-subtitle>Sistema di gestione dati</p></div><form id=loginForm class=login-form><div class=input-group><label for=username>Nome utente</label> <input type=text id=username name=username placeholder="" autocomplete=username required></div><div class=input-group><label for=password>Password</label> <input type=password id=password name=password placeholder="" autocomplete=current-password required></div><button type=submit class=login-button id=loginButton><span>Accedi</span></button></form></div></div></main><div id=configFileManager class="config-file-manager hidden"><div class=fm-top-header><div class=fm-title-group><button id=backToAssetsBtn class="premium-button secondary small" style=margin-right:15px><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 style=margin-right:5px><path d="M19 12H5M12 19l-7-7 7-7"/></svg> Back to Assets</button><h2>File Explorer</h2><div class=fm-info-icon title="Gestione File di Configurazione"><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><circle cx=12 cy=12 r=10></circle><line x1=12 y1=16 x2=12 y2=12></line><line x1=12 y1=8 x2=12.01 y2=8></line></svg></div></div><div class=fm-top-nav><button id=configManagerBackBtn class=nav-circle-btn><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button> <button id=fmForwardBtn class="nav-circle-btn disabled" disabled=disabled><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M5 12h14M12 5l7 7-7 7"/></svg></button></div></div><div class=fm-main-area><div id=fmExplorerView class=fm-card><div class=fm-toolbar><div class=fm-search-wrapper><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><circle cx=11 cy=11 r=8></circle><line x1=21 y1=21 x2=16.65 y2=16.65></line></svg> <input type=text id=fmSearchInput placeholder=Search></div><div class=fm-toolbar-actions><button id=addFolderBtn class="fm-btn dark"><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path><line x1=12 y1=11 x2=12 y2=17></line><line x1=9 y1=14 x2=15 y2=14></line></svg> New folder</button> <button id=addJsonBtn class="fm-btn dark"><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1=12 y1=12 x2=12 y2=18></line><line x1=9 y1=15 x2=15 y2=15></line></svg> Upload file</button></div></div><div id=fmPathDisplay class=fm-path-display>root/</div><div id=fileTree class=fm-file-list></div></div><div id=fmEditorView class="fm-card hidden" style=flex-direction:column;overflow:hidden;height:100%><div class=fm-editor-header><button id=fmEditorBackBtn class="fm-btn text-only"><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M19 12H5M12 19l-7-7 7-7"/></svg> Torna ai file</button> <span id=currentEditingFileLabel class=fm-filename-display>filename.json</span> <button id=saveFileBtn class="fm-btn primary">Salva Modifiche</button></div><div id=monacoEditorContainer class=monaco-full-height></div><div id=emptyEditorState style=display:none></div><div id=editorToolbar style=display:none></div></div></div></div><div id=welcomeDashboard class="dashboard hidden"><div class=welcome-dashboard-content><div class=welcome-animation><h1 class=welcome-title>Benvenuto!</h1><p class=welcome-subtitle>Smart Machinery Lab Dashboard</p><div class=loading-dots><span></span> <span></span> <span></span></div></div></div></div><div id=mainDashboard class="main-dashboard hidden"><header class=dashboard-header><div class=dashboard-header-content><img src=logos/logo.png alt="Presezzi Extrusion SPA Logo" class=dashboard-logo> <button id=logoutButton class=logout-button-header>Logout</button></div></header><div class=dashboard-container><div class=tabs-sidebar id=tabsSidebar><div class=main-tabs id=mainTabs><button class=tab-button data-tab=analytics><span class=tab-icon><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1=12 y1=22.08 x2=12 y2=12></line></svg> </span><span class=tab-label data-i18n=nav.assets>Assets</span></button> <button class=tab-button data-tab=chatbot><span class=tab-icon><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg> </span><span class=tab-label data-i18n=nav.chatbot>Chatbot</span></button> <button class="tab-button active" data-tab=import><span class=tab-icon><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><ellipse cx=12 cy=5 rx=9 ry=3></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path></svg> </span><span class=tab-label data-i18n=nav.storage>Storage</span></button> <button class=tab-button data-tab=systemOptions><span class=tab-icon><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><circle cx=12 cy=12 r=3></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg> </span><span class=tab-label data-i18n=nav.systemOptions>System Options</span></button> <button class=tab-button data-tab=adminPanel id=adminPanelTabBtn style=display:none><span class=tab-icon><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg> </span><span class=tab-label>Admin Panel</span></button></div><div class=bottom-tabs></div><button class="tab-button back-button" id=backButton style=display:none><span class=tab-icon><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M19 12H5"></path><polyline points="12 19 5 12 12 5"></polyline></svg> </span><span class=tab-label>Indietro</span></button> <button class="tab-button analysis-tab-button" data-tab=analysisData id=analysisDataTab style=display:none><span class=tab-icon><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1=16 y1=13 x2=8 y2=13></line><line x1=16 y1=17 x2=8 y2=17></line><polyline points="10 9 9 9 8 9"></polyline></svg> </span><span class=tab-label>Analisi Dati</span></button></div><div class=dashboard-main-content><div class="tab-content active" id=importTab><div class=excel-section><div class=import-header><h2>Import File Excel</h2><button class=upload-button id=uploadButton style=display:none><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1=12 y1=3 x2=12 y2=15></line></svg> Carica File</button> <input type=file id=excelFileInput accept=.xlsx,.xls multiple=multiple style=display:none></div><div class=files-list id=filesList style=display:none><div class=files-list-header style=display:flex;justify-content:space-between;align-items:center;margin-bottom:10px><h3 class=files-list-title style=margin:0>File caricati</h3><button id=createGroupButton class=create-group-button style="padding:5px 10px;background:var(--gray-medium);color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:13px"><svg width=14 height=14 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 style=margin-right:4px;vertical-align:text-bottom><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path><line x1=12 y1=11 x2=12 y2=17></line><line x1=9 y1=14 x2=15 y2=14></line></svg> Crea Gruppo</button></div><div class=files-selector id=filesSelector></div></div><div class=file-controls id=fileControls style=display:none><button class=view-excel-button id=viewExcelButton>Visualizza Excel</button> <button class=delete-excel-button id=deleteExcelButton>Elimina</button></div><div class=excel-viewer id=excelViewer style=display:none><div class=excel-viewer-header><h2 id=excelViewerTitle>Contenuto Excel</h2><div class=excel-controls><button class=list-all-button id=listAllButton title="List All"><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M9 11l3 3L22 4"></path><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg> List all</button><div class=error-navigator id=errorNavigator style="display:none;align-items:center;gap:5px;background:rgba(255,0,0,.2);padding:4px 8px;border-radius:4px;border:1px solid rgba(255,255,255,.3)"><span id=errorCounter style=color:#fff;font-size:13px;font-weight:500>0 Errori</span> <button id=prevErrorBtn class=nav-arrow-btn title="Errore Precedente"><svg width=14 height=14 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><polyline points="15 18 9 12 15 6"></polyline></svg></button> <button id=nextErrorBtn class=nav-arrow-btn title="Errore Successivo"><svg width=14 height=14 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><polyline points="9 18 15 12 9 6"></polyline></svg></button></div><button class=edit-excel-button id=editExcelButton title=Modifica><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> Modifica</button> <button class=export-excel-button id=exportExcelButton title=Esporta style=display:none><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1=12 y1=15 x2=12 y2=3></line></svg> Esporta</button> <button class=zoom-button id=zoomOutButton title=Riduci><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><circle cx=11 cy=11 r=8></circle><line x1=21 y1=21 x2=16.65 y2=16.65></line><line x1=8 y1=11 x2=14 y2=11></line></svg></button> <span class=zoom-level id=zoomLevel>100%</span> <button class=zoom-button id=zoomInButton title=Ingrandisci><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><circle cx=11 cy=11 r=8></circle><line x1=21 y1=21 x2=16.65 y2=16.65></line><line x1=11 y1=8 x2=11 y2=14></line><line x1=8 y1=11 x2=14 y2=11></line></svg></button> <button class=close-viewer-button id=closeViewerButton><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18></line></svg></button></div></div><div class=excel-table-wrapper><div class=excel-table-container id=excelTableContainer></div></div><div class=excel-sheet-selector-bottom id=excelSheetSelectorBottom style=display:none><label for=sheetSelectorBottom>Foglio:</label> <select id=sheetSelectorBottom class=sheet-selector-bottom></select></div></div></div></div><div class=tab-content id=analyticsTab><div class=analytics-content><div class=analytics-header><h2 data-i18n=assets.title>Gestione Assets</h2><button class=add-machine-button id=addBoxButton><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=12 y1=5 x2=12 y2=19></line><line x1=5 y1=12 x2=19 y2=12></line></svg> <span data-i18n=assets.add>Aggiungi un asset</span></button></div><div class=machines-grid id=boxesGrid></div></div></div><div class=tab-content id=analysisDataTab><div class=analysis-data-content><div class=analysis-header-section><h2 id=selectedMachineName>Macchina</h2><p>Abbina un file Excel a questa macchina per l'analisi dei dati</p></div><div class=machine-actions id=machineActions style=display:none><button class=delete-machine-button id=deleteMachineButton><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg> Elimina Macchina</button></div><div class=machine-excel-assignment id=machineExcelAssignment><div class=assignment-section><h3>File Excel associato</h3><div class=excel-assignment-area id=excelAssignmentArea><p class=no-excel-message>Nessun file Excel associato</p></div><button class=assign-excel-button id=assignExcelButton><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1=12 y1=3 x2=12 y2=15></line></svg> Seleziona File Excel</button> <input type=file id=machineExcelInput accept=.xlsx,.xls style=display:none></div></div></div></div><div class=modal-overlay id=deleteModalOverlay style=display:none><div class=modal-container><div class=modal-header><h3>Conferma Eliminazione</h3></div><div class=modal-body><p id=deleteModalMessage>Sei sicuro di voler eliminare questa macchina?</p></div><div class=modal-footer><button class="modal-button cancel-button" id=modalCancelButton>Annulla</button> <button class="modal-button confirm-button" id=modalConfirmButton>Elimina</button></div></div></div><div class=modal-overlay id=boxContentModal style=display:none><div class="modal-container large-modal"><div class=modal-header><h3 id=boxContentTitle>Contenuto Box</h3><button class=close-modal-icon id=closeBoxContentModal style="background:0 0;border:none;cursor:pointer"><svg width=24 height=24 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18></line></svg></button></div><div class="modal-body box-content-body"></div></div></div><div class=tab-content id=chatbotTab><div class=chatbot-container><div class=chatbot-header><h2>Chatbot Assistente</h2><p>Fai una domanda e riceverai una risposta</p></div><div class=chatbot-messages id=chatbotMessages><div class="message bot-message"><div class=message-avatar><svg width=24 height=24 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg></div><div class=message-content><p>Ciao! Sono il tuo assistente virtuale. Come posso aiutarti oggi?</p></div></div></div><div class=chatbot-input-container><input type=text id=chatbotInput class=chatbot-input placeholder="Scrivi un messaggio..." autocomplete=off> <button id=chatbotSendButton class=chatbot-send-button><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=22 y1=2 x2=11 y2=13></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg></button></div></div></div><div class=tab-content id=systemOptionsTab><div class=options-container style="padding:30px;max-width:800px;margin:0 auto"><div class=options-header style=margin-bottom:30px><h2 data-i18n=options.title style=font-size:24px;color:var(--text-dark);margin-bottom:10px>Opzioni di Sistema</h2><p style=color:var(--text-light)>Personalizza la tua esperienza</p></div><div id=systemOptionsContainer style=display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:20px><div class=options-card style="background:#fff;border-radius:12px;padding:25px;box-shadow:0 4px 12px rgba(0,0,0,.05)"><div class=option-group style=margin-bottom:25px><label style=display:block;font-weight:600;margin-bottom:12px;color:var(--text-dark) data-i18n=options.language>Lingua / Language</label><div class=language-selector style=display:flex;gap:15px><label class=lang-option style=cursor:pointer;display:flex;align-items:center><input type=radio name=appLanguage value=it style=margin-right:8px> <span style=font-weight:500>Italiano ðŸ‡®ðŸ‡¹</span></label> <label class=lang-option style=cursor:pointer;display:flex;align-items:center><input type=radio name=appLanguage value=en style=margin-right:8px> <span style=font-weight:500>English ðŸ‡¬ðŸ‡§</span></label></div></div></div><div class=options-card style="background:#fff;border-radius:12px;padding:25px;box-shadow:0 4px 12px rgba(0,0,0,.05)"><label style=display:block;font-weight:600;margin-bottom:15px;color:var(--text-dark) data-i18n=options.serverStatus>Stato Server / Uptime</label><div class=server-status-grid style=display:grid;grid-template-columns:1fr;gap:10px><div class=status-tile style="padding:12px;background:#f8f9fa;border-radius:8px;border-left:4px solid #2ecc71;display:flex;justify-content:space-between;align-items:center"><span style=font-size:12px;color:#666 data-i18n=options.health>Salute Sistema</span><div style=font-weight:700;color:#2ecc71><span data-i18n=options.statusOnline>Online</span> (99.9%)</div></div><div class=status-tile style=padding:12px;background:#f8f9fa;border-radius:8px;display:flex;justify-content:space-between;align-items:center><span style=font-size:12px;color:#666 data-i18n=options.uptime>Uptime Totale</span><div style=font-weight:700;color:#444>14d 06h 22m</div></div></div></div><div id=personalizationWidget class=options-card style="background:#fff;border-radius:12px;padding:25px;box-shadow:0 4px 12px rgba(209,22,23,.1);border:2px dashed #d11617;display:none;grid-column:1/-1"><div style=display:flex;justify-content:space-between;align-items:baseline;margin-bottom:20px><h3 style=color:#d11617;font-size:18px;font-weight:700>ModalitÃ  Personalizzazione Avanzata</h3><span style=font-size:12px;color:#d11617;font-weight:600>VISIBILE SOLO IN EDIT MODE</span></div><div style=display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px><div class=option-group><label style=display:block;font-weight:600;margin-bottom:12px;color:var(--text-dark) data-i18n=options.changeLogo>Cambia Logo Sistema</label><div style=display:flex;align-items:center;gap:15px><div id=logoPreviewContainer style="width:80px;height:40px;border:1px dashed #ddd;border-radius:8px;display:flex;align-items:center;justify-content:center;background:#fafafa;overflow:hidden"><img id=systemLogoPreview src=logos/logo.png style=max-width:100%;max-height:100%;object-fit:contain></div><input type=file id=systemLogoInput accept=image/* style=display:none> <button onclick='document.getElementById("systemLogoInput").click()' class="premium-button secondary" style="font-size:12px;padding:6px 12px">Sfogli...</button></div></div><div class=option-group><label style=display:block;font-weight:600;margin-bottom:12px;color:var(--text-dark) data-i18n=options.customizeColors>Colori</label><div style="display:grid;grid-template-columns:1fr 1fr;gap:10px"><div style="display:flex;align-items:center;justify-content:space-between;background:#fdfdfd;padding:8px;border-radius:6px;border:1px solid #eee"><span style=font-size:11px data-i18n=options.colorPrimary>Primario</span> <input type=color id=colorPrimaryPicker value=#D11617 style="border:none;width:25px;height:25px;cursor:pointer;background:0 0"></div><div style="display:flex;align-items:center;justify-content:space-between;background:#fdfdfd;padding:8px;border-radius:6px;border:1px solid #eee"><span style=font-size:11px data-i18n=options.colorHeader>Header</span> <input type=color id=colorHeaderPicker value=#ffffff style="border:none;width:25px;height:25px;cursor:pointer;background:0 0"></div><div style="display:flex;align-items:center;justify-content:space-between;background:#fdfdfd;padding:8px;border-radius:6px;border:1px solid #eee"><span style=font-size:11px data-i18n=options.colorSidebar>Sidebar</span> <input type=color id=colorSidebarPicker value=#ffffff style="border:none;width:25px;height:25px;cursor:pointer;background:0 0"></div><div style="display:flex;align-items:center;justify-content:space-between;background:#fdfdfd;padding:8px;border-radius:6px;border:1px solid #eee"><span style=font-size:11px data-i18n=options.colorText>Testo</span> <input type=color id=colorTextPicker value=#222222 style="border:none;width:25px;height:25px;cursor:pointer;background:0 0"></div></div></div><div class=option-group><label style=display:block;font-weight:600;margin-bottom:12px;color:var(--text-dark) data-i18n=options.textSettings>Testo & Font</label><div style=display:flex;flex-direction:column;gap:10px><div style="display:flex;align-items:center;justify-content:space-between;background:#fdfdfd;padding:8px;border-radius:6px;border:1px solid #eee"><span style=font-size:11px data-i18n=options.fontFamily>Carattere</span> <select id=fontFamilySelector style="padding:4px;border:1px solid #ddd;border-radius:4px;font-size:11px;cursor:pointer"><option value="'Raleway', sans-serif">Raleway (Default)</option><option value="'Roboto', sans-serif">Roboto</option><option value="'Inter', sans-serif">Inter</option><option value="'Ubuntu', sans-serif">Ubuntu</option><option value="'Montserrat', sans-serif">Montserrat</option><option value="'Courier New', monospace">Technical (Monospace)</option></select></div><div style="display:flex;flex-direction:column;background:#fdfdfd;padding:8px;border-radius:6px;border:1px solid #eee;gap:5px"><div style=display:flex;justify-content:space-between><span style=font-size:11px data-i18n=options.fontSize>Dimensione Testo</span> <span id=fontSizeDisplay style=font-size:11px;font-weight:700>16px</span></div><input type=range id=fontSizeSlider min=12 max=24 value=16 style=width:100%;cursor:pointer></div></div></div><div class=option-group><label style=display:block;font-weight:600;margin-bottom:12px;color:var(--text-dark)>Azioni Riordino</label><div style=display:flex;flex-direction:column;gap:10px><button id=customizeTabsBtn class="premium-button secondary" style="font-size:12px;padding:6px 12px;width:100%">Riordina Tab Laterali</button></div></div></div></div><div class=options-card style="background:#fff;border-radius:12px;padding:25px;box-shadow:0 4px 12px rgba(0,0,0,.05);grid-column:1/-1"><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:15px><label style=display:block;font-weight:600;color:var(--text-dark) data-i18n=options.systemLog>Log di Sistema</label><div class=log-controls style=display:flex;gap:10px><select id=logTypeFilter style="padding:4px 8px;border-radius:4px;border:1px solid #ddd;font-size:12px"><option value=all>Tutti</option><option value=info>Info</option><option value=warning>Warning</option><option value=error>Error</option></select> <input type=date id=logDateFilter style="padding:4px 8px;border-radius:4px;border:1px solid #ddd;font-size:12px"></div></div><div id=systemLogContainer style="height:150px;overflow-y:auto;background:#fafafa;border:1px solid #eee;border-radius:8px;padding:10px;font-family:monospace;font-size:11px"><div style=color:#999;text-align:center;padding-top:60px>Caricamento log...</div></div></div></div><div style="margin-top:30px;display:flex;justify-content:space-between;align-items:center;background:#fff;padding:20px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.05)"><div style=display:flex;gap:15px><button id=customizeLayoutBtn class="premium-button secondary" style="font-size:14px;padding:10px 20px"><span data-i18n=options.editLayout>Personalizza Interfaccia</span></button> <button id=cancelPersonalizationBtn class="premium-button secondary" style="font-size:14px;padding:10px 20px;display:none;background:#95a5a6;color:#fff"><span>Annulla</span></button> <button id=openDocsBtn class="premium-button secondary" style=display:flex;align-items:center;gap:8px><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1=16 y1=13 x2=8 y2=13></line><line x1=16 y1=17 x2=8 y2=17></line></svg> <span data-i18n=docs.open>Guida</span></button></div><button id=saveOptionsBtn class="premium-button primary" style="padding:10px 30px" data-i18n=options.save>Salva Tutto</button></div></div></div><div id=adminPanelTab class=tab-content style=display:none><div class=content-header style=margin-bottom:30px><h2 class=content-title style=display:flex;align-items:center;gap:10px><span style=width:8px;height:32px;background:#d11617;border-radius:4px;display:block></span> Pannello Amministrazione</h2><p class=content-subtitle>Gestione Licenze e Richieste</p></div><div style=display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:30px><div class=options-card style="background:#fff;border-radius:12px;padding:25px;box-shadow:0 4px 12px rgba(0,0,0,.05)"><h3 style=margin-top:0;color:#333;display:flex;align-items:center;gap:10px><span style=background:#e8f5e9;color:#2ecc71;width:38px;height:38px;display:flex;align-items:center;justify-content:center;border-radius:50%><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2.5 stroke-linecap=round stroke-linejoin=round><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx=8.5 cy=7 r=4></circle><line x1=20 y1=8 x2=20 y2=14></line><line x1=23 y1=11 x2=17 y2=11></line></svg> </span>Genera Nuova Licenza</h3><div style=margin-top:20px;display:flex;flex-direction:column;gap:15px><input type=text id=newLicenseUser class=premium-input placeholder=Username style=margin:0> <input type=text id=newLicensePass class=premium-input placeholder=Password style=margin:0> <select id=newLicenseRole class=premium-input style=margin:0><option value=user>User (Standard)</option><option value=admin>Admin</option></select> <button id=createLicenseBtn class="premium-button success" style=margin-top:10px>Crea Licenza</button></div></div><div class=options-card style="background:#fff;border-radius:12px;padding:25px;box-shadow:0 4px 12px rgba(0,0,0,.05)"><h3 style=margin-top:0;color:#333;display:flex;align-items:center;justify-content:space-between><div style=display:flex;align-items:center;gap:10px><span style=background:#fff3e0;color:#ff9800;width:38px;height:38px;display:flex;align-items:center;justify-content:center;border-radius:50%><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2.5 stroke-linecap=round stroke-linejoin=round><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22 6 12 13 2 6"></polyline></svg> </span>Richieste in Attesa</div><button id=refreshRequestsBtn onclick=window.loadAdminRequests() title="Aggiorna Richieste" style="background:#f8f9fa;border:1px solid #eee;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#666;transition:all .2s"><svg width=14 height=14 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2.5 stroke-linecap=round stroke-linejoin=round><path d="M23 4v6h-6"></path><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg></button></h3><div id=adminRequestsList style=margin-top:20px;max-height:300px;overflow-y:auto;display:flex;flex-direction:column;gap:10px><div style=text-align:center;color:#999;padding:20px>Caricamento...</div></div></div><div class=options-card style="background:#fff;border-radius:12px;padding:25px;box-shadow:0 4px 12px rgba(0,0,0,.05);grid-column:1/-1"><div class=card style="box-shadow:0 4px 6px rgba(0,0,0,.05);border:1px solid #eee;border-radius:8px;overflow:hidden"><div style="display:flex;background:#f8f9fa;border-bottom:1px solid #eee;padding:15px"><div style="flex:1;text-align:center;border-right:1px solid #eee"><div style=font-size:.8rem;color:#666;text-transform:uppercase;letter-spacing:.5px>Totale</div><div id=totalLicenses style=font-size:1.8rem;font-weight:700;color:#333>-</div></div><div style="flex:1;text-align:center;border-right:1px solid #eee"><div style=font-size:.8rem;color:#666;text-transform:uppercase;letter-spacing:.5px>Attive</div><div id=activeLicenses style=font-size:1.8rem;font-weight:700;color:#2ecc71>-</div></div><div style=flex:1;text-align:center><div style=font-size:.8rem;color:#666;text-transform:uppercase;letter-spacing:.5px>Admin</div><div id=adminCount style=font-size:1.8rem;font-weight:700;color:#9b59b6>-</div></div></div><div class=card-header style=display:flex;justify-content:space-between;align-items:center;padding:15px;background:#fff><h3 style=margin:0;display:flex;align-items:center;gap:10px;font-size:1.1rem><span style=background:#e3f2fd;color:#2196f3;padding:6px;border-radius:50%;display:flex><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx=9 cy=7 r=4></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg> </span>Gestione Licenze</h3><div style=display:flex;gap:10px;align-items:center><div style=position:relative><input type=text id=searchInput placeholder="Cerca utente..." style="padding:6px 10px 6px 30px;border:1px solid #ddd;border-radius:4px;font-size:.9rem;width:200px"> <svg width=14 height=14 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 style=position:absolute;left:10px;top:50%;transform:translateY(-50%);color:#999><circle cx=11 cy=11 r=8></circle><line x1=21 y1=21 x2=16.65 y2=16.65></line></svg></div><button onclick=window.loadAdminUsers() title="Aggiorna Utenti" style="background:#f8f9fa;color:#333;border:1px solid #ddd;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s"><svg width=14 height=14 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2.5 stroke-linecap=round stroke-linejoin=round><path d="M23 4v6h-6"></path><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg></button></div></div><div class=table-container style="max-height:450px;overflow-y:auto;border-top:1px solid #eee"><table style=width:100%;border-collapse:collapse;font-size:13px><thead style=background:#f8f9fa;color:#666;font-weight:600;text-align:left;position:sticky;top:0;z-index:10><tr><th style="padding:12px;border-bottom:2px solid #eee">Utente</th><th style="padding:12px;border-bottom:2px solid #eee">Password (Codificata)</th><th style="padding:12px;border-bottom:2px solid #eee">Ruolo</th><th style="padding:12px;border-bottom:2px solid #eee">Stato</th><th style="padding:12px;border-bottom:2px solid #eee">Data Creazione</th><th style="padding:12px;border-bottom:2px solid #eee;text-align:right">Azioni</th></tr></thead><tbody id=licensesTableBody><tr><td colspan=6 style=padding:30px;text-align:center;color:#999>Inizializzazione tabella...</td></tr></tbody></table></div></div></div></div></div></div><div id=docsModal class=modal-overlay style=display:none;align-items:center;justify-content:center;z-index:10005><div class="modal-container large-modal" style=width:90%;max-width:1000px;height:85vh;display:flex;flex-direction:column><div class=modal-header><h3 data-i18n=docs.title>Documentazione</h3><button class=close-modal-icon id=closeDocsModal style="background:0 0;border:none;cursor:pointer"><svg width=24 height=24 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18></line></svg></button></div><div class=modal-body style=flex:1;overflow-y:auto;padding:0><div id=docsFullContent class=docs-container style=padding:30px></div></div></div></div></div></div><div id=excelAssociationModal class=modal-overlay style=display:none><div class=modal-container><div class=modal-header><h3>Seleziona File Excel</h3></div><div class=modal-body><p style=margin-bottom:15px;color:var(--gray-dark)>Scegli un file Excel da associare al Box:</p><div id=excelFilesList class=excel-files-list></div></div><div class=modal-footer><button id=cancelExcelAssociation class="modal-button cancel-button">Annulla</button></div></div></div><div id=validationModal class=modal-overlay style=display:none><div class=modal-container style=max-width:600px><div class=modal-header><h3 id=validationModalTitle>Risultati Validazione</h3></div><div class=modal-body><div id=validationModalContent style=max-height:400px;overflow-y:auto;white-space:pre-wrap;font-family:monospace;font-size:13px;line-height:1.6></div></div><div class=modal-footer><button id=closeValidationModal class=modal-button style=background:var(--primary-red);color:var(--white)>OK</button></div></div></div><div id=createGroupModal class=modal-overlay style=display:none><div class=modal-container><div class=modal-header><h3>Crea Gruppo File</h3></div><div class=modal-body><label for=groupNameInput style=display:block;margin-bottom:8px;font-weight:600>Nome Gruppo:</label> <input type=text id=groupNameInput placeholder="Es: Progetto Alpha" style="width:100%;padding:10px;margin-bottom:15px;border:1px solid #ddd;border-radius:4px"><p style=margin-bottom:10px;font-weight:600>Seleziona file da raggruppare:</p><div id=groupFilesList style="max-height:200px;overflow-y:auto;border:1px solid #eee;padding:10px;border-radius:4px"></div></div><div class=modal-footer><button id=cancelCreateGroup class="modal-button cancel-button">Annulla</button> <button id=confirmCreateGroup class=modal-button style=background:var(--primary-red);color:var(--white)>Raggruppa</button></div></div></div><div id=createBoxModal class=modal-overlay style=display:none><div class="modal-container premium-modal"><div class="modal-header premium-header"><h3 data-i18n=assets.createModal.title>Crea Asset</h3><button class="close-modal-icon minimalist-close" id=closeCreateBoxModal><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18></line></svg></button></div><div class=modal-body><label for=boxNameInput class=premium-label data-i18n=assets.createModal.nameLabel>Nome Asset:</label> <input type=text id=boxNameInput class=premium-input placeholder="Es: Pressa 1" data-i18n-placeholder=assets.createModal.namePlaceholder> <label for=assetCodeInput class=premium-label data-i18n=assets.createModal.codeLabel>Sigla asset <span style=font-weight:400;color:#888>(opzionale)</span>:</label> <input type=text id=assetCodeInput class=premium-input placeholder="Es: MCH-001" data-i18n-placeholder=assets.createModal.codePlaceholder> <label for=orderNumberInput class=premium-label data-i18n=assets.createModal.orderLabel>MAA1 (Commessa) <span style=font-weight:400;color:#888>(opzionale)</span>:</label> <input type=text id=orderNumberInput class=premium-input placeholder="Es: 123456" data-i18n-placeholder=assets.createModal.orderPlaceholder> <label for=clientInput class=premium-label data-i18n=assets.createModal.clientLabel>Cliente <span style=font-weight:400;color:#888>(opzionale)</span>:</label> <select id=clientSelect class=premium-input style=margin-bottom:15px;display:none></select> <input type=text id=clientInput class=premium-input placeholder="Es: Presezzi" data-i18n-placeholder=assets.createModal.clientPlaceholder style=margin-bottom:0></div><div class="modal-footer premium-footer"><button id=cancelCreateBox class="premium-button secondary" data-i18n=assets.createModal.btnCancel>Annulla</button> <button id=confirmCreateBox class="premium-button primary" data-i18n=assets.createModal.btnCreate>Crea Asset</button></div></div></div><div id=activationModal class=modal-overlay style=display:none><div class="modal-container premium-modal"><div class="modal-header premium-header"><h3 id=activationModalTitle data-i18n=activation.title>Configurazione Macchina</h3><button class="close-modal-icon minimalist-close" id=closeActivationModal><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18></line></svg></button></div><div class="modal-body premium-body"><form id=activationForm><div class=form-section><label class=section-label><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 style=vertical-align:middle;margin-right:5px><rect x=2 y=2 width=20 height=20 rx=5 ry=5></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1=17.5 y1=6.5 x2=17.51 y2=6.5></line></svg> <span data-i18n=activation.imageLabel>Immagine Asset</span></label><div class=photo-upload-container id=photoUploadContainer><div class=photo-preview-placeholder id=photoPreviewPlaceholder><svg width=40 height=40 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=1.5><rect x=3 y=3 width=18 height=18 rx=2 ry=2></rect><circle cx=8.5 cy=8.5 r=1.5></circle><polyline points="21 15 16 10 5 21"></polyline></svg> <span data-i18n=activation.imagePlaceholder>Trascina o clicca per caricare una foto</span></div><img id=photoPreview class="photo-preview hidden" src="" alt=Preview> <input type=file id=assetPhotoInput accept=image/* style=display:none> <button type=button id=removePhotoBtn class="remove-photo-btn hidden"><svg width=14 height=14 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18></line></svg></button></div></div><div class=form-section style=display:flex;flex-direction:column;gap:15px><div style=margin-bottom:5px><label class=section-label style=font-size:.95rem;font-weight:600;color:#444;margin-bottom:8px;display:block><span data-i18n=activation.plcTypeLabel>Tipologia PLC</span> <span class=required-asterisk style=color:var(--primary-red)>*</span></label><div class=card-selection-group style=display:flex;gap:10px;max-width:400px><label class=selection-card style=flex:1;margin:0><input type=radio name=plcType value=RockWell required><div class="card-content simple-card" style="padding:10px;border:1px solid #ddd;border-radius:6px;text-align:center;transition:all .2s"><span class=card-title style=font-size:.9rem;font-weight:500 data-i18n=activation.plcRockwell>RockWell</span></div></label> <label class=selection-card style=flex:1;margin:0><input type=radio name=plcType value=Simens required><div class="card-content simple-card" style="padding:10px;border:1px solid #ddd;border-radius:6px;text-align:center;transition:all .2s"><span class=card-title style=font-size:.9rem;font-weight:500 data-i18n=activation.plcSiemens>Simens</span></div></label> <label class=selection-card style=flex:1;margin:0><input type=radio name=plcType value=Altro required><div class="card-content simple-card" style="padding:10px;border:1px solid #ddd;border-radius:6px;text-align:center;transition:all .2s"><span class=card-title style=font-size:.9rem;font-weight:500 data-i18n=activation.plcOther>Altro</span></div></label></div></div><div id=plcConfigContainer></div><div style=margin-top:5px><button type=button id=addMorePlcsBtn class="premium-button secondary" style=width:100%;border-style:dashed;padding:12px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:8px><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2.5><line x1=12 y1=5 x2=12 y2=19></line><line x1=5 y1=12 x2=19 y2=12></line></svg> <span data-i18n=activation.addPlc>Aggiungi PLC</span></button></div><div style=margin-top:10px><label for=databaseCodeInput class=section-label style=font-size:.95rem;font-weight:600;color:#444;margin-bottom:8px;display:block><span data-i18n=activation.dbCodeLabel>Codice Database</span></label><div class=input-wrapper><input type=text id=databaseCodeInput name=databaseCode placeholder=MCC data-i18n-placeholder=activation.dbPlaceholder class="premium-input clean-input" style=width:100%></div></div></div><div id=excelSection class=form-section style="margin-top:20px;border-top:1px solid #eee;padding-top:20px"><label class=section-label><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 style=vertical-align:middle;margin-right:5px><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1=16 y1=13 x2=8 y2=13></line><line x1=16 y1=17 x2=8 y2=17></line></svg> <span data-i18n=activation.excelLabel>Associazione Excel</span></label><div id=associatedFileDisplay style="display:none;padding:10px;border:1px solid #2ecc71;border-radius:4px;color:#2ecc71;background:rgba(46,204,113,.05);font-weight:500;text-align:center;margin-bottom:10px">File: <span id=associatedFileName></span></div><div style=display:flex;gap:10px;align-items:center;margin-top:10px><div id=addExcelContainer style=flex:1><button type=button id=modalAddExcelBtn class=premium-button style="background:var(--primary-red);width:100%;justify-content:center;padding:10px 15px"><svg width=16 height=16 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 style=margin-right:6px><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1=12 y1=3 x2=12 y2=15></line></svg> <span data-i18n=activation.uploadExcel>Carica Nuovo Excel</span></button> <input type=file id=modalExcelInput accept=.xlsx,.xls style=display:none></div><button type=submit class="premium-button confirm-button" style="padding:10px 20px"><span data-i18n=activation.saveBtn>Salva Configurazione</span></button></div></div><div id=frequencySection style=display:none></div><input type=radio name=bufferRequired value=no checked=checked style=display:none></form></div></div></div><div id=configFileManager class="dashboard-container hidden" style=position:fixed;top:0;left:0;width:100vw;height:100vh;background:#f4f7f6;z-index:2000;flex-direction:column><div style="background:#fff;padding:15px 20px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #ddd;box-shadow:0 2px 4px rgba(0,0,0,.05)"><div style=display:flex;align-items:center;gap:15px><button id=backToAssetsBtn class="premium-button secondary" style="padding:8px 12px;font-size:.9em"><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=19 y1=12 x2=5 y2=12></line><polyline points="12 19 5 12 12 5"></polyline></svg> <span data-i18n=nav.back>Indietro</span></button><div style=display:flex;flex-direction:column><h2 style=margin:0;font-size:1.2rem;color:#333 data-i18n=fm.title>File di Configurazione</h2><span id=fmPathDisplay style=font-size:.85rem;color:#666>root/</span></div></div><div style=display:flex;gap:10px><button id=fmNewFolderBtn class="premium-button secondary"><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path><line x1=12 y1=11 x2=12 y2=17></line><line x1=9 y1=14 x2=15 y2=14></line></svg> <span data-i18n=fm.newFolder>Nuova Cartella</span></button> <button id=fmUploadBtn class="premium-button primary"><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1=12 y1=3 x2=12 y2=15></line></svg> <span data-i18n=storage.upload>Carica File</span></button> <input type=file id=fmUploadInput style=display:none></div></div><div style="padding:10px 20px;background:#fff;border-bottom:1px solid #eee;display:flex;align-items:center;justify-content:space-between"><div class=search-box style=width:300px><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><circle cx=11 cy=11 r=8></circle><line x1=21 y1=21 x2=16.65 y2=16.65></line></svg> <input type=text id=fmSearchInput placeholder="Cerca file..." data-i18n-placeholder=fm.searchPlaceholder class=search-input></div><div id=fileCountDisplay style=color:#888;font-size:.9em></div></div><div id=fileTree style=flex:1;overflow-y:auto;padding:20px;display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:15px;align-content:start></div></div><div id=internalAlertModal class="modal-overlay hidden" style=z-index:3000><div class=modal-container style=max-width:400px><div class=modal-header><h3>Attenzione</h3></div><div class=modal-body><p id=internalAlertMessage style=font-size:1rem;color:#333>Message</p></div><div class=modal-footer><button class=modal-button id=internalAlertOkBtn style=background:var(--primary-red);color:#fff>OK</button></div></div></div><div id=imagePreviewModal class="modal-overlay hidden" style=z-index:4000;background:rgba(0,0,0,.85);display:flex;align-items:center;justify-content:center><div style=position:relative;max-width:90vw;max-height:90vh><button id=closeImagePreview style="position:absolute;top:-40px;right:-40px;background:0 0;border:none;color:#fff;cursor:pointer"><svg width=30 height=30 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18></line></svg></button> <img id=fullImagePreview src="" style="max-width:100%;max-height:90vh;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,.5)"></div></div><div id=internalConfirmModal class="modal-overlay hidden" style=z-index:3000><div class=modal-container style=max-width:400px><div class=modal-header><h3>Conferma</h3></div><div class=modal-body><p id=internalConfirmMessage style=font-size:1rem;color:#333>Sei sicuro?</p></div><div class=modal-footer><button class="modal-button cancel-button" id=internalConfirmCancelBtn>Annulla</button> <button class=modal-button id=internalConfirmOkBtn style=background:var(--primary-red);color:#fff>Conferma</button></div></div></div><div id=internalPromptModal class="modal-overlay hidden" style=z-index:3000><div class=modal-container style=max-width:400px><div class=modal-header><h3 id=internalPromptTitle>Inserisci Valore</h3></div><div class=modal-body><input type=text id=internalPromptInput style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:1rem"></div><div class=modal-footer><button class="modal-button cancel-button" id=internalPromptCancelBtn>Annulla</button> <button class=modal-button id=internalPromptOkBtn style=background:var(--primary-red);color:#fff>OK</button></div></div></div><div id=tagSelectorModal class="modal-overlay hidden" style=z-index:3100><div class=modal-container style=max-width:90%;width:1200px><div class=modal-header><h3 id=tagSelectorTitle>Seleziona Tag</h3></div><div class=modal-body><div style="margin-bottom:20px;display:flex;gap:20px;background:#f9f9f9;padding:15px;border-radius:8px;border:1px solid #eee;align-items:flex-end"><div style=flex:1><label style=display:block;font-size:11px;text-transform:uppercase;color:#888;font-weight:700;margin-bottom:5px>Filtra Excel (Tag ID o Traduzioni)</label> <input type=text id=tagSelectorSearch placeholder="Cerca nella tabella..." style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:14px"></div><div style=flex:1;display:flex;gap:10px;align-items:flex-end><div style=flex:1><label style=display:block;font-size:11px;text-transform:uppercase;color:#888;font-weight:700;margin-bottom:5px>Inserimento manuale</label> <input type=text id=tagSelectorManualInput placeholder="Inserisci tag non presente nell'excel..." style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:14px"></div><button id=tagSelectorManualBtn class=modal-button style="background:var(--primary-red);color:#fff;height:38px;padding:0 15px">Usa manuale</button></div></div><div id=tagSelectorTableContainer style="max-height:500px;overflow:auto;border:1px solid #eee;border-radius:4px"><table id=tagSelectorTable style=width:100%;border-collapse:collapse;font-size:13px><thead style=position:sticky;top:0;background:#f5f5f5;z-index:10><tr id=tagSelectorHeader></tr></thead><tbody id=tagSelectorList></tbody></table></div></div><div class=modal-footer><line x1=12 y1=3 x2=12 y2=15></line> <span data-i18n=activation.uploadExcel>Carica Nuovo Excel</span> <input type=file id=modalExcelInput accept=.xlsx,.xls style=display:none></div><button type=submit class="premium-button confirm-button" style="padding:10px 20px"><span data-i18n=activation.saveBtn>Salva Configurazione</span></button></div></div><div id=frequencySection style=display:none></div><input type=radio name=bufferRequired value=no checked=checked style=display:none><div id=configFileManager class="dashboard-container hidden" style=position:fixed;top:0;left:0;width:100vw;height:100vh;background:#f4f7f6;z-index:2000;flex-direction:column><div style="background:#fff;padding:15px 20px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #ddd;box-shadow:0 2px 4px rgba(0,0,0,.05)"><div style=display:flex;align-items:center;gap:15px><button id=backToAssetsBtn class="premium-button secondary" style="padding:8px 12px;font-size:.9em"><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=19 y1=12 x2=5 y2=12></line><polyline points="12 19 5 12 12 5"></polyline></svg> <span data-i18n=nav.back>Indietro</span></button><div style=display:flex;flex-direction:column><h2 style=margin:0;font-size:1.2rem;color:#333 data-i18n=fm.title>File di Configurazione</h2><span id=fmPathDisplay style=font-size:.85rem;color:#666>root/</span></div></div><div style=display:flex;gap:10px><button id=fmNewFolderBtn class="premium-button secondary"><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path><line x1=12 y1=11 x2=12 y2=17></line><line x1=9 y1=14 x2=15 y2=14></line></svg> <span data-i18n=fm.newFolder>Nuova Cartella</span></button> <button id=fmUploadBtn class="premium-button primary"><svg width=18 height=18 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1=12 y1=3 x2=12 y2=15></line></svg> <span data-i18n=storage.upload>Carica File</span></button> <input type=file id=fmUploadInput style=display:none></div></div><div style="padding:10px 20px;background:#fff;border-bottom:1px solid #eee;display:flex;align-items:center;justify-content:space-between"><div class=search-box style=width:300px><svg width=20 height=20 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><circle cx=11 cy=11 r=8></circle><line x1=21 y1=21 x2=16.65 y2=16.65></line></svg> <input type=text id=fmSearchInput placeholder="Cerca file..." data-i18n-placeholder=fm.searchPlaceholder class=search-input></div><div id=fileCountDisplay style=color:#888;font-size:.9em></div></div><div id=fileTree style=flex:1;overflow-y:auto;padding:20px;display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:15px;align-content:start></div></div><div id=internalAlertModal class="modal-overlay hidden" style=z-index:3000><div class=modal-container style=max-width:400px><div class=modal-header><h3>Attenzione</h3></div><div class=modal-body><p id=internalAlertMessage style=font-size:1rem;color:#333>Message</p></div><div class=modal-footer><button class=modal-button id=internalAlertOkBtn style=background:var(--primary-red);color:#fff>OK</button></div></div></div><div id=imagePreviewModal class="modal-overlay hidden" style=z-index:4000;background:rgba(0,0,0,.85);display:flex;align-items:center;justify-content:center><div style=position:relative;max-width:90vw;max-height:90vh><button id=closeImagePreview style="position:absolute;top:-40px;right:-40px;background:0 0;border:none;color:#fff;cursor:pointer"><svg width=30 height=30 viewBox="0 0 24 24" fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18></line></svg></button> <img id=fullImagePreview src="" style="max-width:100%;max-height:90vh;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,.5)"></div></div><div id=internalConfirmModal class="modal-overlay hidden" style=z-index:3000><div class=modal-container style=max-width:400px><div class=modal-header><h3>Conferma</h3></div><div class=modal-body><p id=internalConfirmMessage style=font-size:1rem;color:#333>Sei sicuro?</p></div><div class=modal-footer><button class="modal-button cancel-button" id=internalConfirmCancelBtn>Annulla</button> <button class=modal-button id=internalConfirmOkBtn style=background:var(--primary-red);color:#fff>Conferma</button></div></div></div><div id=internalPromptModal class="modal-overlay hidden" style=z-index:3000><div class=modal-container style=max-width:400px><div class=modal-header><h3 id=internalPromptTitle>Inserisci Valore</h3></div><div class=modal-body><input type=text id=internalPromptInput style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:1rem"></div><div class=modal-footer><button class="modal-button cancel-button" id=internalPromptCancelBtn>Annulla</button> <button class=modal-button id=internalPromptOkBtn style=background:var(--primary-red);color:#fff>OK</button></div></div></div><div id=tagSelectorModal class="modal-overlay hidden" style=z-index:3100><div class=modal-container style=max-width:90%;width:1200px><div class=modal-header><h3 id=tagSelectorTitle>Seleziona Tag</h3></div><div class=modal-body><div style="margin-bottom:20px;display:flex;gap:20px;background:#f9f9f9;padding:15px;border-radius:8px;border:1px solid #eee;align-items:flex-end"><div style=flex:1><label style=display:block;font-size:11px;text-transform:uppercase;color:#888;font-weight:700;margin-bottom:5px>Filtra Excel (Tag ID o Traduzioni)</label> <input type=text id=tagSelectorSearch placeholder="Cerca nella tabella..." style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:14px"></div><div style=flex:1;display:flex;gap:10px;align-items:flex-end><div style=flex:1><label style=display:block;font-size:11px;text-transform:uppercase;color:#888;font-weight:700;margin-bottom:5px>Inserimento manuale</label> <input type=text id=tagSelectorManualInput placeholder="Inserisci tag non presente nell'excel..." style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:14px"></div><button id=tagSelectorManualBtn class=modal-button style="background:var(--primary-red);color:#fff;height:38px;padding:0 15px">Usa manuale</button></div></div><div id=tagSelectorTableContainer style="max-height:500px;overflow:auto;border:1px solid #eee;border-radius:4px"><table id=tagSelectorTable style=width:100%;border-collapse:collapse;font-size:13px><thead style=position:sticky;top:0;background:#f5f5f5;z-index:10><tr id=tagSelectorHeader></tr></thead><tbody id=tagSelectorList></tbody></table></div></div><div class=modal-footer><button id=tagSelectorCancelBtn class="modal-button cancel-button">Annulla</button></div></div></div><div id=configWizardModal class="modal-overlay hidden" style=z-index:3050><div class=modal-container style=max-width:500px><div class=modal-header><h3 id=configWizardTitle>Configurazione Guidata</h3></div><div class=modal-body><div id=configWizardForm style=display:flex;flex-direction:column;gap:15px></div></div><div class=modal-footer><button class="modal-button cancel-button" id=configWizardCancelBtn>Annulla</button> <button class=modal-button id=configWizardConfirmBtn style=background:var(--primary-red);color:#fff>Genera Configurazione</button></div></div></div><script src="script.js?v=DeployFixV3"></script></body></html>